<!DOCTYPE html>
<html lang="ru">
<head>
    <title>gRPC-Web Test</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<header>
    <h1>gRPC-Web Test</h1>
    {{ template "menu" . }}
</header>

<main>
    <div class="container">
        <div>
            <button id="sayHelloBtn" class="btn">SayHello</button>
        </div>

        <pre id="result"></pre>
    </div>
</main>

{{ template "footer" . }}

<script type="module">
    import {sayHello} from '/static/js/bundle.js';

    const resultBox = document.getElementById('result');
    const sayHelloBtn = document.getElementById('sayHelloBtn');

    function setStatus(message, isError = false) {
        resultBox.textContent = (isError ? '❌ ' : '✅ ') + message + '\n';
    }

    sayHelloBtn.addEventListener('click', async () => {
        const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo1NCwicm9sZXMiOlsidXNlciJdLCJpc3MiOiJ2YWRvLXBpbmciLCJzdWIiOiJhY2Nlc3MiLCJleHAiOjE3NjI1MDYwNzksImlhdCI6MTc2MjQxOTY3OX0.qj4p8ltCakA8dNUknAEsc0k2fqWsxjbXfjpPU0YDPvc";
        sayHello("Вадим", token)
            .then((resp) => {
                setStatus("Response: " + resp.message);
                console.log("Ответ от сервера:", resp.message)
            })
            .catch((err) => {
                console.error("Ошибка:", err)
                setStatus("Error, " + err, true);
            });
    })
</script>

</body>
</html>