<!DOCTYPE html>
<html lang="ru">
<head>
    <title>gRPC-Web Test</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<header>
    <h1>gRPC-Web Test</h1>
    {{ template "menu" . }}
</header>

<main>
    <div class="container">
        <div>
            <button id="sayHelloBtn" class="btn">SayHello</button>
            <button id="pingHelloBtn" class="btn">PingHello</button>
        </div>

        <pre id="result"></pre>
    </div>
</main>

{{ template "footer" . }}

<script type="module">
    import {sayHello, ping} from '/static/js/bundle.js';

    const resultBox = document.getElementById('result');
    const sayHelloBtn = document.getElementById('sayHelloBtn');
    const pingBtn = document.getElementById('pingHelloBtn');

    function setStatus(message, isError = false) {
        resultBox.textContent = (isError ? '❌ ' : '✅ ') + message + '\n';
    }

    sayHelloBtn.addEventListener('click', async () => {
        sayHello("Вадим")
            .then((resp) => {
                setStatus("Response: " + resp.message);
            })
            .catch((err) => {
                setStatus("Error, " + err, true);
            });
    })

    pingBtn.addEventListener('click', async () => {
        ping()
            .then((resp) => {
                setStatus("Response: " + resp.message);
            })
            .catch((err) => {
                setStatus("Error, " + err, true);
            });
    })
</script>

</body>
</html>