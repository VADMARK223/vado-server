<!DOCTYPE html>
<html lang="ru">
<head>
    <title>gRPC-Web Test</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<header>
    <h1>gRPC-Web Test</h1>
    {{ template "menu" . }}
</header>

<main>
    <div class="container">
        <div>
            <button id="pingButton" class="btn">Test Ping (gRPC-Web)</button>
        </div>

        <pre id="result"></pre>
    </div>
</main>

{{ template "footer" . }}

<script type="module">
    import { pingServer } from '/static/js/bundle.js';

    const resultBox = document.getElementById('result');
    const pingButton = document.getElementById('pingButton');

    function setStatus(message, isError = false) {
        resultBox.textContent = (isError ? '❌ ' : '✅ ') + message + '\n';
    }

    pingButton.addEventListener('click', async () => {
        setStatus('Выполняется Ping...');
        try {
            const resp = await pingServer();
            setStatus('Ответ: run=' + resp.getRun());
        } catch (err) {
            setStatus(err.message, true);
        }
    });
</script>

</body>
</html>