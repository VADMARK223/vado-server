<!DOCTYPE html>
<html lang="ru">
<head>
    <title>WebSocket Chat</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<header>
    <h1>WebSocket Chat</h1>
    {{ template "menu" . }}
</header>

<main>
    <div class="container">
        <div class="chat">
            <div id="status"></div>
            <div id="messages" class="chat-messages"></div>

            <div class="chat-input-row">
                <input id="msgInput" class="test-input" type="text" placeholder="Enter message..."
                       aria-label="Message input">
                <button id="sendBtn" class="btn"><i class="fa-solid fa-paper-plane"></i></button>
            </div>
        </div>
    </div>
</main>

{{ template "footer" . }}

<script type="module">
    import {initChat} from "../static/js/bundle.js";

    initChat({
        status: document.getElementById("status"),
        messages: document.getElementById("messages"),
        input: document.getElementById("msgInput"),
        sendBtn: document.getElementById("sendBtn")
    });
</script>

<!--<script type="module">
    const url = "ws://localhost:5555/ws"
    const socket = new WebSocket(url);

    const statusDiv = document.getElementById("status");
    const messagesDiv = document.getElementById("messages");
    const input = document.getElementById("msgInput");
    const sendBtn = document.getElementById("sendBtn");

    socket.onopen = () => {
        updateStatus("ðŸŸ¢ Connected (" + url + ")")
    };

    socket.onmessage = (event) => {
        addMessage(event.data);
    };

    socket.onerror = (err) => {
        updateStatus("âŒ Error: " + err.message)
    };

    socket.onclose = () => {
        updateStatus("ðŸ”´ Disconnected");
    };

    sendBtn.onclick = () => sendMessage();
    input.onkeypress = (e) => {
        if (e.key === "Enter") sendMessage();
    };

    function sendMessage() {
        const text = input.value.trim();
        if (!text) return;

        socket.send(text);
        input.value = "";
    }

    function updateStatus(text) {
        statusDiv.textContent = text
    }

    function addMessage(text) {
        const div = document.createElement("div");
        div.textContent = text;
        messagesDiv.appendChild(div);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
</script>-->

</body>
</html>